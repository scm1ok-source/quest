<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Квест «Перекодировка через аттрибуты» — Пошаговая инструкция </title>
  <style>
    /* === БАЗОВАЯ ТЕМА (светлая) === */
    :root{
      --bg:#ffffff; --text:#1e293b; --muted:#475569; --line:#e2e8f0; --card:#f8fafc;
      --accent:#0ea5e9; --accent-2:#6366f1; --ok:#16a34a; --warn:#d97706; --err:#dc2626;
    }
    html,body{height:100%}
    body{margin:0; background:var(--bg); color:var(--text);
      font:16px/1.55 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,"Helvetica Neue",Arial,"Apple Color Emoji","Segoe UI Emoji"}
    .container{max-width:1100px; margin-inline:auto; padding:32px 20px 80px}
    header{display:grid; gap:12px; margin-bottom:20px}
    header h1{font-size:clamp(26px,3vw,36px); margin:0}
    header p{margin:0; color:var(--muted)}
    .badge{display:inline-flex; align-items:center; gap:8px; background:#e0f2fe; border:1px solid #7dd3fc; color:#0369a1; padding:6px 10px; border-radius:999px; font-size:13px}
    .kbd{display:inline-block; padding:.15em .45em; border:1px solid #cbd5e1; border-radius:6px; background:#f1f5f9; font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace; font-size:.9em}

    /* Карточки и сетки */
    .card{background:var(--card); border:1px solid var(--line); border-radius:12px; padding:18px; margin-top:16px}
    .card h2,.card h3{margin-top:0}
    .grid{display:grid; gap:16px}
    .two{grid-template-columns:repeat(2,minmax(0,1fr))}
    .three{grid-template-columns:repeat(3,minmax(0,1fr))}
    @media (max-width:920px){.two,.three{grid-template-columns:1fr}}

    /* Шаги, плейсхолдеры изображений */
    .step{position:relative; padding:16px; border-radius:12px; border:1px dashed #cbd5e1; background:#fff}
    .fig{display:grid; place-items:center; background:#fff; border:2px dashed #cbd5e1; border-radius:12px; padding:14px; min-height:140px; color:#64748b; text-align:center}
    .fig strong{color:#0f172a}
    .need{background:#ecfeff; border:1px solid #67e8f9; color:#0369a1; border-radius:10px; padding:10px; font-size:14px}

    /* Чек-лист, прогресс, подсказки */
    .checklist label{display:flex; align-items:flex-start; gap:10px; margin:10px 0; cursor:pointer}
    .checklist input[type="checkbox"]{width:18px; height:18px; accent-color:var(--ok)}
    .progress{height:8px; background:#e5e7eb; border:1px solid #e5e7eb; border-radius:999px; overflow:hidden}
    .progress>span{display:block; height:100%; width:0; background:linear-gradient(90deg,var(--accent),var(--accent-2)); transition:width .25s ease}
    .tip{display:inline-flex; align-items:center; gap:6px; color:var(--accent); cursor:pointer}
    .popover{position:relative; display:inline-block}
    .popover-content{position:absolute; inset:auto auto auto 0; transform:translateY(8px); min-width:260px; background:#fff; border:1px solid var(--line); border-radius:10px; padding:12px; box-shadow:0 10px 30px rgba(2,6,23,.12); display:none}
    .popover[data-open="true"] .popover-content{display:block}

    /* Таблица-пример */
    table{width:100%; border-collapse:collapse}
    th,td{border:1px solid var(--line); padding:8px 10px}
    th{background:#eef2ff}

    /* Итог */
    .cta{display:flex; align-items:center; justify-content:space-between; gap:14px; margin-top:20px}
    .btn{appearance:none; border:none; border-radius:12px; padding:12px 16px; font-weight:700; cursor:pointer; color:#fff; background:linear-gradient(135deg, var(--ok), #22c55e)}
    .btn[disabled]{opacity:.45; cursor:not-allowed}
    .trophy{width:42px; height:42px; border-radius:50%; display:grid; place-items:center; background:radial-gradient(50% 50% at 50% 50%, rgba(52,211,153,.9), rgba(14,165,233,.85)); box-shadow:0 6px 22px rgba(14,165,233,.25)}
    .muted{color:var(--muted)}

    /* === Overrides: подписи и отступ превью === */

/* Убрать подписи под картинками */
.step figure figcaption{
  display: none !important;
}

/* Превью чуть ниже заголовка/текста */
.step figure{
  margin: 24px 0 12px;   /* было 12px 0; можно увеличить до 28–32px */
}

/* На всякий случай: контролируем высоту и вписывание */
.step figure .media{
  aspect-ratio: 16 / 9;  /* можно 4/3, если хотите превью выше */
  width: 100%;
  display: flex; align-items: center; justify-content: center;
  background: #fff; overflow: hidden; border-bottom: 1px solid var(--line);
}
.step figure img{
  max-width: 100%; max-height: 100%;
  width: auto; height: auto; object-fit: contain; display: block;
}

 /* === FIXED progress dock === */
#progress-dock{
position: fixed;
top: 12px; /* прижать к верхнему краю окна */
right: 16px; /* плавающий виджет у правого края */
left: auto;
width: min(420px, 92vw);
z-index: 1000;
background: rgba(255,255,255,0.97);
backdrop-filter: blur(6px);
border: 1px solid #e5e7eb;
box-shadow: 0 8px 24px rgba(2,6,23,.08);
}
</style>
</head>
<body>
<div class="container">
<header>
<span class="badge">Квест «Перекодировка через аттрибуты»</span>
<h1>Пошаговый гайд для <strong>Recode by attribute</strong>.</h1>
<p>Цель: научиться использовать перекодировку переменных с помощью атрибутов в онлайн‑конструкторе анкет.</p>
<div id="progress-dock" class="card" role="status" aria-live="polite">
<div style="display:flex;justify-content:space-between;align-items:center;gap:12px;margin-bottom:8px">
<strong>Прогресс квеста</strong>
<span class="muted" id="progress-label">0% выполнено</span>
</div>
<div class="progress" aria-label="Прогресс"><span id="progress-bar" style="width:0%"></span></div>
</div>
<div class="progress" aria-label="Прогресс"><span id="progress-bar"></span></div>
</div>
</header>

    <!-- Функции конструктора, которые понадобятся -->
<section class="card">
  <h2>0) Что понадобится</h2>
  <div class="grid three">

    <div class="step">
      <h3>Поле <span class="kbd">Raw</span> режим для списков</h3>
      <p class="muted">Это способ вставить <strong>весь список ответов разом</strong> через стандартный <strong>Copy/Paste</strong>.</p>
      <figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Raw1.png"
               alt="Поле Raw — вкладка и поле ввода" loading="lazy">
        </div>
        <figcaption>Поле Raw — вкладка и поле ввода</figcaption>
      </figure>
    </div>

    <div class="step">
      <h3>Иконка фильтра и «карандаш»</h3>
      <p class="muted">Доступ к возможностям перекодировки и задания различных фильтров.</p>
      <figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/FilterAndPen.png"
               alt="Иконка фильтра и кнопка редактирования (карандаш)" loading="lazy">
        </div>
        <figcaption>Иконка фильтра и кнопка редактирования (карандаш)</figcaption>
      </figure>
    </div>

    <div class="step">
      <h3>Правило <span class="kbd">recode by attribute</span></h3>
      <p class="muted">Перекодировка по значению аттрибута у исходных ответов.</p>
      <figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Recode.png"
               alt="Настройка правила Recode by attribute" loading="lazy">
        </div>
        <figcaption>Настройка правила Recode by attribute</figcaption>
      </figure>
    </div>

  </div>
</section>



<!-- Шаг 1 -->
<section class="card" id="step1">
<h2>1) Подготовьте таблицу в Excel с колонками <span class="kbd">code</span>, <span class="kbd">text</span>, <span class="kbd">new</span></h2>
<div class="step">
<ol>
<li>Создайте таблицу в Excel с тремя колонками: <strong>code</strong>, <strong>text</strong>, <strong>new</strong>.
Что бы конструктор распознал структуру таблицы, важно, сохранять названия колонок "code" и "text".
При создании новых атрибутов (колонок) используйте латинские буквы в названии. </li>
<li>Заполните 10 строк:</li>
  <ul>
  <li>в колонке <strong>code</strong> — исходные коды вариантов ответов (1, 2, 3...), </li>
  <li>в колонке <strong>text</strong> — названия (лейблы) для этих кодов ("тюльпан", "нарцисс", "яблоня"),</li>
  <li>в колонке <strong>new</strong> — новые категории после перекодировки (1 = "цветы", 2 = "деревья").</li>
  </ul>
<div class="principle">
<p><strong>Принцип работы:</strong></p>
<p>Исходные варианты объединяются в более крупные группы. Например:</p>
<ul>
<li>Тюльпан (код 1) → получает новый код 1 ("цветы")</li>
<li>Нарцисс (код 2) → получает новый код 1 ("цветы")</li>
<li>Яблоня (код 3) → получает новый код 2 ("деревья")</li>
</ul>
<p>Результат: вместо отдельных категорий получаем две обобщённые группы.</p>
</div>
</li>
</ol>
<div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/table.png"
               alt="Таблица пример" loading="lazy">
        </div>
        <figcaption>Таблица пример</figcaption>
      </figure></div>
<details style="margin-top:10px">
<pre>01;Вариант 1;A
02;Вариант 2;A
03;Вариант 3;A
04;Вариант 4;A
05;Вариант 5;B
06;Вариант 6;B
07;Вариант 7;B
08;Вариант 8;C
09;Вариант 9;C
10;Вариант 10;C</pre>
</details>
<div class="checklist" data-step="1">
<label><input type="checkbox"> Файл Excel создан</label>
<label><input type="checkbox"> 10 строк заполнены</label>
<label><input type="checkbox"> Коды для новых обобщенных групп указаны в колонке <span class="kbd">new</span></label>
</div>
</div>
</section>

    
    <!-- Шаг 2 -->
    <section class="card" id="step2">
      <h2> 2) Вставьте таблицу в окне <span class="kbd">Raw</span>. </h2>
      <div class="step">
        <ol>
          <li>Создайте новый вопрос <span class="kbd">q1 (s)</span>.</li>
          <li> Нажмите на иконку <span class="kbd">Raw</span>, чтобы сделать ее активной.</li>
          <li> Удалите весь текст в появившемся окне.</li>
        </ol>
        <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Raw.png"
               alt="Raw пустой" loading="lazy">
        </div>
        <figcaption>Raw пустой</figcaption>
      </figure></div>
        <ol>
          <li> Скопируйте таблицу в пустое поле.</li>
          <li>  Сохраните изменения.</li>
         </ol>
        <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Raw2.png"
               alt="Raw заполненный" loading="lazy">
        </div>
        <figcaption>Raw заполненный</figcaption>
      </figure></div>
        <div class="checklist" data-step="1">
         <label><input type="checkbox"> Вопрос q1 создан</label>
         <label><input type="checkbox"> Таблица в окно Raw скопирована</label>
         <label><input type="checkbox"> Изменения сохранены</label>
</div>
    </section>

    <!-- Шаг 3 -->
    <section class="card" id="step3">
      <h2>3) Вернитесь в режим конструктора</h2>
      <div class="step">
        <p>Нажмите иконку <span class="kbd">Raw</span> и убедитесь, что все стрки считались. Аттрибут <span class="kbd">new</span> записан внутри вариантов ответов в q1 (внешне список не меняется).</p>
         <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Raw3.png"
               alt="Raw заполненный" loading="lazy">
        </div>
        <figcaption>Raw заполненный</figcaption>
      </figure></div>
        <div class="checklist" data-step="3">
          <label><input type="checkbox"> Окно <span class="kbd">Raw</span> закрыто</label>
          <label><input type="checkbox"> Изменения в q1 сохранены</label>
        </div>
      </div>
    </section>

    <!-- Шаг 4 -->
    <section class="card" id="step4">
      <h2>4) Создайте второй вопрос Single Choice (q2) с вариантами ответов из <strong>new</strong>strong> </h2>
      <div class="step">
        <ol>
          <li>Добавьте новый вопрос <strong>Single Choice</strong> — <strong>q2</strong>.</li>
          <li>Создайте варианты ответа: <strong>1 - цветы</strong>, <strong>2 - деревья</strong>.</li>
        </ol>
      <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/q2.png"
               alt="q2" loading="lazy">
        </div>
        <figcaption>q2</figcaption>
      </figure></div>
        <div class="checklist" data-step="4">
          <label><input type="checkbox"> Создан вопрос q2 типа Single Choice</label>
          <label><input type="checkbox"> Добавлены варианты ответа с кодами как у атрибута new</label>
        </div>
      </div>
    </section>

    <!-- Шаг 5 -->
    <section class="card" id="step5">
      <h2>5) Настройте фильтр <span class="kbd">recode by attribute</span> для q2</h2>
      <div class="step">
        <ol>
          <li>Нажмите иконку фильтра.</li>
         </ol>
       <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Filter.png"
               alt="filter" loading="lazy">
        </div>
        <figcaption>filter</figcaption>
      </figure></div>
            <ol>
          <li>Откройте панель c командами логики нажав на "карандаш" .</li>
         </ol>
        <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Edit.png"
               alt="Edit" loading="lazy">
        </div>
        <figcaption>Edit</figcaption>
      </figure></div>
             <ol>
        <li>Выберите правило <strong> recode by attribute</strong> .</li>
                     </ol>
            <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Recode2.png"
               alt="recode2" loading="lazy">
        </div>
        <figcaption>recode2</figcaption>
      </figure></div>
        <ol>
          <li>В поле <em>Select option</em> укажите вопрос <strong>q1</strong>. В <em>пустом окне</em> введите название атрибута, который используем для перекодировки -  <strong>new</strong>.</li>
              </ol>
         <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Recode3.png"
               alt="recode2" loading="lazy">
        </div>
        <figcaption>recode2</figcaption>
      </figure></div>
        <ol>
        <li>Сохраните правило. </li>
         </ol>
        <div class="checklist" data-step="5">
          <label><input type="checkbox"> Активна иконка фильтров у q2</label>
          <label><input type="checkbox"> Выбрано «recode by attribute» </label>
          <label><input type="checkbox"> Указаны правила Select Option=Q1 и атрибут new</label>
        </div>
      </div>
    </section>

   <!-- Шаг 6 -->
    <section class="card" id="step5">
      <h2>5) Скройте вопрос q2 от респондентов </h2>
      <div class="step">
        <ol>
          <li>Сделайте апдейт ссылки и проверьте корректность работы перекодировки. </li>
          <li> На панели c командами логики выберите <strong>ASK NEVER</strong>.</li>
            <li>Сохраните изменения.</li>
        </ol>
               <div class="checklist" data-step="5">
          <label><input type="checkbox"> Перекодировка корректно работает </label>
          <label><input type="checkbox"> q2 скрыт от респондентов </label>
         </div>
      </div>
    </section>
    <!-- Частые ошибки -->
    <section class="card" id="mistakes">
      <h2>Частые ошибки и быстрые решения</h2>
      <div class="grid two">
               <div class="step"><strong>Источник не тот</strong><br><span class="muted">В Select Option должен быть выбран именно q1.</span></div>
        <div class="step"><strong>Опечатка в названии свойства</strong><br><span class="muted">«New» должно совпадать до символа и регистра.</span></div>
        <div class="step"><strong>Нет вариантов ответов из атрибута new (1/2)  в q2</strong><br><span class="muted">Добавьте их вручную перед настройкой recode.</span></div>
          <div class="step"><strong>Не все коды из атрубита new указаны в q2</strong><br><span class="muted">Если в колонке new использовали коды 1, 2, 3, 4, 5,  то все 5 значений должны быть прописаны в q2.</span></div>
      </div>
    </section>

    <!-- Итог -->
    <section class="card" id="finish">
      <h2>Итог и совет</h2>
      <p><strong>Резюме:</strong> вы научились записывать в переменную ответы через команду «recode by attribute». </p>
      <p class="muted">Совет: такой подход используется для работы с географией: город - страта - федеральный округ. Как правиль новые переменные, которые получают при перекодировке скрыты от респондентов. </p>

      <div class="cta">
        <div style="display:flex;align-items:center;gap:12px">
          <div class="trophy" id="trophy" style="opacity:.35; filter:grayscale(1)" title="Квест‑пройден"></div>
          <div>
            <div><strong>«Квест‑пройден»</strong> активируется, когда все чек‑листы отмечены.</div>
            <div class="muted">Кнопка станет доступной автоматически.</div>
          </div>
        </div>
        <button class="btn" id="doneBtn" disabled>Выполнено</button>
      </div>
    </section>
  </div>

  <script>
    // Прогресс по чек-листам
    (function(){
      const checks = Array.from(document.querySelectorAll('.checklist input[type="checkbox"]'));
      const bar = document.getElementById('progress-bar');
      const label = document.getElementById('progress-label');
      const doneBtn = document.getElementById('doneBtn');
      const trophy = document.getElementById('trophy');
      function update(){
        const done = checks.filter(c=>c.checked).length;
        const total = checks.length || 1;
        const pct = Math.round(done/total*100);
        if(bar) bar.style.width = pct + '%';
        if(label) label.textContent = pct + '% выполнено';
        if(pct === 100){
          doneBtn.removeAttribute('disabled');
          if(trophy){trophy.style.opacity = 1; trophy.style.filter = 'none';}
        } else {
          doneBtn.setAttribute('disabled','');
          if(trophy){trophy.style.opacity = .35; trophy.style.filter = 'grayscale(1)';}
        }
      }
      checks.forEach(c=> c.addEventListener('change', update));
      update();
      doneBtn && doneBtn.addEventListener('click', ()=>{
        alert('Поздравляем! Квест пройден. Перекодировка по свойству настроена.');
      });
    })();

    // Примитивный поповер (если добавим элементы с классом .popover)
    document.querySelectorAll('.popover').forEach(pop=>{
      pop.addEventListener('click',()=>{
        const isOpen = pop.getAttribute('data-open') === 'true';
        pop.setAttribute('data-open', String(!isOpen));
      });
    });
  </script>
</body>
</html>













































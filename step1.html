<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Квест «Перекодировка через аттрибуты» — Пошаговая инструкция </title>
  <style>
  /* ===== БАЗОВАЯ ТЕМА ===== */
  :root{
    --bg:#0b1220;          /* тёмно-синий фон */
    --panel:#0f172a;       /* панель/карточки */
    --text:#e2e8f0;        /* основной текст */
    --muted:#94a3b8;       /* вторичный текст */
    --line:#22304a;        /* границы/делители */
    --brand:#60a5fa;       /* акцент */
    --brand-2:#22d3ee;     /* доп. акцент */
    --ok:#22c55e;          /* успех */
    --warn:#f59e0b;        /* предупреждение */
    --err:#ef4444;         /* ошибка */
    --radius:14px;
    --shadow:0 10px 30px rgba(0,0,0,.35);
    --w: 880px;            /* ширина колонки контента */
  }

  html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Inter,Arial,sans-serif;}
  img{max-width:100%;height:auto;border-radius:12px}

  /* Контейнер колонки */
  .doc{
    max-width: var(--w);
    margin: 32px auto 120px;
    padding: 0 20px;
  }

  /* Шапка */
  .hero{
    background: radial-gradient(1200px 500px at 50% -100px, rgba(96,165,250,.25), transparent 60%);
    padding: 18px 0 6px;
    margin-bottom: 8px;
  }
  .title{
    font-size: clamp(26px, 4vw, 36px);
    font-weight: 800;
    letter-spacing: .2px;
    margin: 0 0 8px;
  }
  .subtitle{
    color: var(--muted);
    font-size: 15px;
    margin: 0;
  }

  /* Оглавление (sticky) */
  .toc{
    position: sticky; top: 16px;
    background: linear-gradient(180deg, rgba(34,48,74,.6), rgba(34,48,74,.35));
    border: 1px solid var(--line);
    border-radius: var(--radius);
    padding: 14px 14px 10px;
    box-shadow: var(--shadow);
    backdrop-filter: blur(6px);
    margin: 18px 0 22px;
  }
  .toc h3{margin:0 0 8px;font-size:14px;color:var(--muted);font-weight:700;letter-spacing:.3px;text-transform:uppercase}
  .toc a{display:block;padding:6px 6px;border-radius:10px;color:var(--text);text-decoration:none;border:1px solid transparent}
  .toc a:hover{background:rgba(96,165,250,.1);border-color:rgba(96,165,250,.25)}
  .toc a.active{background:rgba(96,165,250,.18);border-color:rgba(96,165,250,.45)}

  /* Карточки шагов */
  .step{
    background: linear-gradient(180deg, rgba(24,33,54,.85), rgba(15,23,42,.85));
    border:1px solid var(--line);
    border-radius: var(--radius);
    padding:18px 16px;
    margin: 16px 0;
    box-shadow: var(--shadow);
  }
  .step h2{margin: 0 0 10px; font-size: clamp(20px, 2.6vw, 24px)}
  .step h3{margin-top:14px;margin-bottom:8px}
  .step .meta{color:var(--muted);font-size:13px;margin-bottom:8px}

  /* Сетка для скринов */
  .shots{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:12px;margin:10px 0}
  figure{margin:0}
  figcaption{color:var(--muted);font-size:12px;margin-top:6px}

  /* Callout-блоки */
  .callout{
    border-left: 4px solid var(--brand);
    background: rgba(96,165,250,.08);
    padding: 10px 12px;
    border-radius: 10px;
    margin: 12px 0;
  }
  .callout.warn{border-left-color:var(--warn);background: rgba(245,158,11,.08)}
  .callout.ok{border-left-color:var(--ok);background: rgba(34,197,94,.08)}

  /* Чек-лист + прогресс (внутри контента) */
  .checklist{display:grid;gap:8px;margin:8px 0}
  .checklist label{display:flex;gap:10px;align-items:flex-start;background:rgba(34,48,74,.5);border:1px solid var(--line);padding:8px 10px;border-radius:10px}
  .checklist input{transform: translateY(2px);}
  .progress{
    width:100%;height:10px;border-radius:999px;background:#0b1424;border:1px solid var(--line);overflow:hidden
  }
  .progress > span{
    display:block;height:100%;width:0%;
    background: linear-gradient(90deg, var(--brand), var(--brand-2));
    transition:width .35s ease;
  }

  /* Плавающая карточка прогресса (fixed) — для вашей проблемы «не фиксируется» */
  .progress-dock{
    position: fixed; right: 16px; bottom: 16px; z-index: 999;
    width: min(360px, 92vw);
    background: linear-gradient(180deg, rgba(24,33,54,.9), rgba(15,23,42,.9));
    border:1px solid var(--line);
    border-radius: 16px;
    box-shadow: var(--shadow);
    padding: 12px 14px;
    backdrop-filter: blur(6px);
  }
  .progress-dock .head{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:8px}
  .progress-dock .muted{color:var(--muted);font-size:12px}

  /* Кнопки */
  .btn{
    display:inline-flex;align-items:center;gap:8px;
    padding:10px 14px;border-radius:12px;border:1px solid rgba(96,165,250,.35);
    background: rgba(96,165,250,.12); color: var(--text); text-decoration:none; font-weight:600;
    transition: transform .08s ease, background .2s ease, border-color .2s ease;
  }
  .btn:hover{transform: translateY(-1px); background: rgba(96,165,250,.18); border-color: rgba(96,165,250,.55)}
  .btn:disabled{opacity:.6;cursor:not-allowed}

  /* Ссылки и код */
  a{color:#93c5fd}
  code,kbd{background:#0b1424;border:1px solid var(--line);padding:2px 6px;border-radius:8px}

  /* Делители + списки */
  hr{border:none;border-top:1px solid var(--line);margin:22px 0}
  ul,ol{padding-left: 22px}

  /* Адаптив */
  @media (max-width: 720px){
    .doc{margin-bottom: 160px}
    .toc{position: static}
  }
</style>
</head>

  <script>
/* ===== Быстрое TOC + Прогресс квеста с localStorage ===== */
(function(){
  const sel = (q, el=document)=>el.querySelector(q);
  const all = (q, el=document)=>Array.from(el.querySelectorAll(q));

  // 1) Собираем TOC из h2
  const h2s = all('h2');
  if (h2s.length){
    const toc = document.createElement('nav');
    toc.className = 'toc';
    toc.innerHTML = '<h3>Оглавление</h3><div class="toc-links"></div>';
    const wrap = sel('.doc') || document.body;
    wrap.prepend(toc);
    const linksWrap = sel('.toc-links', toc);
    h2s.forEach(h=>{
      const id = h.id || h.textContent.trim().toLowerCase().replace(/\s+/g,'-').replace(/[^\w\-]+/g,'');
      h.id = id;
      const a = document.createElement('a');
      a.href = `#${id}`;
      a.textContent = h.textContent.replace(/^\d+\)\s*/,'');
      linksWrap.appendChild(a);
    });
    // Активный пункт
    const obs = new IntersectionObserver((ents)=>{
      ents.forEach(ent=>{
        if(ent.isIntersecting){
          const id = ent.target.id;
          all('.toc a').forEach(a=>a.classList.toggle('active', a.getAttribute('href') === '#'+id));
        }
      });
    }, {rootMargin:'-40% 0px -55% 0px', threshold: 0.01});
    h2s.forEach(h=>obs.observe(h));
  }

  // 2) Чек-лист и прогресс
  const storageKey = 'quest_step1_checks';
  const checks = all('.checklist input[type="checkbox"]');
  const progressBar = sel('#progress-bar');
  const progressLabel = sel('#progress-label');

  function restore(){
    try{
      const saved = JSON.parse(localStorage.getItem(storageKey)||'[]');
      checks.forEach((c,i)=> c.checked = !!saved[i] );
    }catch(e){}
  }
  function save(){
    const arr = checks.map(c=> c.checked ? 1 : 0);
    localStorage.setItem(storageKey, JSON.stringify(arr));
  }
  function update(){
    const done = checks.filter(c=>c.checked).length;
    const total = checks.length || 1;
    const pct = Math.round(done/total*100);
    if (progressBar) progressBar.style.width = pct + '%';
    if (progressLabel) progressLabel.textContent = `${pct}% выполнено`;
    // кнопка "Квест пройден", если есть
    const finishBtn = sel('#finish');
    if (finishBtn) finishBtn.disabled = pct < 100;
  }

  if (checks.length){
    restore();
    update();
    checks.forEach(c=>{
      c.addEventListener('change', ()=>{ save(); update(); });
    });
  }

  // 3) Плавная прокрутка для якорей
  document.addEventListener('click', (e)=>{
    const a = e.target.closest('a[href^="#"]');
    if(!a) return;
    const id = a.getAttribute('href').slice(1);
    const el = document.getElementById(id);
    if(!el) return;
    e.preventDefault();
    el.scrollIntoView({behavior:'smooth', block:'start'});
    history.replaceState(null, '', '#'+id);
  });
})();
</script>

<body>
  <div class="hero">
    <div class="doc">
      <h1 class="title">Квест «Перекодировка через атрибуты»</h1>
      <p class="subtitle">Пошаговый гайд для Recode by attribute</p>
    </div>
  </div>

  <div class="doc">
    <!-- Пример чеклиста для шагов (необязательно, но даёт прогресс) -->
    <div class="step">
      <div class="meta">Чек-лист</div>
      <div class="checklist">
        <label><input type="checkbox"> Подготовлен Excel с колонками <code>code</code>, <code>text</code>, <code>new</code></label>
        <label><input type="checkbox"> Таблица вставлена в Raw и сохранена</label>
        <label><input type="checkbox"> Создан вопрос q2 и добавлены коды из <code>new</code></label>
        <label><input type="checkbox"> Настроен фильтр <em>recode by attribute</em></label>
        <label><input type="checkbox"> q2 скрыт (ASK NEVER), проверена работа</label>
      </div>
    </div>

    <!-- Функции конструктора, которые понадобятся -->
 <section class="step">
  <h2>0) Что понадобится</h2>
  <div class="grid three">

    <div class="step">
      <h3>Поле <span class="kbd">Raw</span> режим для списков</h3>
      <p class="muted">Это способ вставить <strong>весь список ответов разом</strong> через стандартный <strong>Copy/Paste</strong>.</p>
      <figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Raw1.png"
               alt="Поле Raw — вкладка и поле ввода" loading="lazy">
        </div>
        <figcaption>Поле Raw — вкладка и поле ввода</figcaption>
      </figure>
    </div>

    <div class="step">
      <h3>Иконка фильтра и «карандаш»</h3>
      <p class="muted">Доступ к возможностям перекодировки и задания различных фильтров.</p>
      <figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/FilterAndPen.png"
               alt="Иконка фильтра и кнопка редактирования (карандаш)" loading="lazy">
        </div>
        <figcaption>Иконка фильтра и кнопка редактирования (карандаш)</figcaption>
      </figure>
    </div>

    <div class="step">
      <h3>Правило <span class="kbd">recode by attribute</span></h3>
      <p class="muted">Перекодировка по значению аттрибута у исходных ответов.</p>
      <figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Recode.png"
               alt="Настройка правила Recode by attribute" loading="lazy">
        </div>
        <figcaption>Настройка правила Recode by attribute</figcaption>
      </figure>
    </div>

  </div>
</section>



<!-- Шаг 1 -->
 <section class="step">
<h2>1) Подготовьте таблицу в Excel с колонками <span class="kbd">code</span>, <span class="kbd">text</span>, <span class="kbd">new</span></h2>
<div class="step">
<ol>
<li>Создайте таблицу в Excel с тремя колонками: <strong>code</strong>, <strong>text</strong>, <strong>new</strong>.
Что бы конструктор распознал структуру таблицы, важно, сохранять названия колонок "code" и "text".
При создании новых атрибутов (колонок) используйте латинские буквы в названии. </li>
<li>Заполните 10 строк:</li>
  <ul>
  <li>в колонке <strong>code</strong> — исходные коды вариантов ответов (1, 2, 3...), </li>
  <li>в колонке <strong>text</strong> — названия (лейблы) для этих кодов ("тюльпан", "нарцисс", "яблоня"),</li>
  <li>в колонке <strong>new</strong> — новые категории после перекодировки (1 = "цветы", 2 = "деревья").</li>
  </ul>
<div class="principle">
<p><strong>Принцип работы:</strong></p>
<p>Исходные варианты объединяются в более крупные группы. Например:</p>
<ul>
<li>Тюльпан (код 1) → получает новый код 1 ("цветы")</li>
<li>Нарцисс (код 2) → получает новый код 1 ("цветы")</li>
<li>Яблоня (код 3) → получает новый код 2 ("деревья")</li>
</ul>
<p>Результат: вместо отдельных категорий получаем две обобщённые группы.</p>
</div>
</li>
</ol>
<div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/table.png"
               alt="Таблица пример" loading="lazy">
        </div>
        <figcaption>Таблица пример</figcaption>
      </figure></div>
<ul>
<li><strong></strong>Проверь себя:</strong></li>
</ul>
  <div class="checklist" data-step="1">
<label><input type="checkbox"> Файл Excel создан</label>
<label><input type="checkbox"> 10 строк заполнены</label>
<label><input type="checkbox"> Коды для новых обобщенных групп указаны в колонке <span class="kbd">new</span></label>
</div>
</div>
</section>

    
    <!-- Шаг 2 -->
   <section class="step">
      <h2> 2) Вставьте таблицу в окне <span class="kbd">Raw</span>. </h2>
      <div class="step">
        <ol>
          <li>Создайте новый вопрос <span class="kbd">q1 (s)</span>.</li>
          <li> Нажмите на иконку <span class="kbd">Raw</span>, чтобы сделать ее активной.</li>
          <li> Удалите весь текст в появившемся окне.</li>
        </ol>
        <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Raw.png"
               alt="Raw пустой" loading="lazy">
        </div>
        <figcaption>Raw пустой</figcaption>
      </figure></div>
        <ol>
          <li> Скопируйте таблицу в пустое поле.</li>
          <li>  Сохраните изменения.</li>
         </ol>
        <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Raw2.png"
               alt="Raw заполненный" loading="lazy">
        </div>
        <figcaption>Raw заполненный</figcaption>
      </figure></div>
        <div class="checklist" data-step="1">
         <label><input type="checkbox"> Вопрос q1 создан</label>
         <label><input type="checkbox"> Таблица в окно Raw скопирована</label>
         <label><input type="checkbox"> Изменения сохранены</label>
</div>
    </section>

    <!-- Шаг 3 -->
   <section class="step">
      <h2>3) Вернитесь в режим конструктора</h2>
      <div class="step">
        <p>Нажмите иконку <span class="kbd">Raw</span> и убедитесь, что все стрки считались. Аттрибут <span class="kbd">new</span> записан внутри вариантов ответов в q1 (внешне список не меняется).</p>
         <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Raw3.png"
               alt="Raw заполненный" loading="lazy">
        </div>
        <figcaption>Raw заполненный</figcaption>
      </figure></div>
        <div class="checklist" data-step="3">
          <label><input type="checkbox"> Окно <span class="kbd">Raw</span> закрыто</label>
          <label><input type="checkbox"> Изменения в q1 сохранены</label>
        </div>
      </div>
    </section>

    <!-- Шаг 4 -->
 <section class="step">
      <h2>4) Создайте второй вопрос Single Choice (q2) с вариантами ответов из <strong>new</strong>strong> </h2>
      <div class="step">
        <ol>
          <li>Добавьте новый вопрос <strong>Single Choice</strong> — <strong>q2</strong>.</li>
          <li>Создайте варианты ответа: <strong>1 - цветы</strong>, <strong>2 - деревья</strong>.</li>
        </ol>
      <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/q2.png"
               alt="q2" loading="lazy">
        </div>
        <figcaption>q2</figcaption>
      </figure></div>
        <div class="checklist" data-step="4">
          <label><input type="checkbox"> Создан вопрос q2 типа Single Choice</label>
          <label><input type="checkbox"> Добавлены варианты ответа с кодами как у атрибута new</label>
        </div>
      </div>
    </section>

    <!-- Шаг 5 -->
  <section class="step">
      <h2>5) Настройте фильтр <span class="kbd">recode by attribute</span> для q2</h2>
      <div class="step">
        <ol>
          <li>Нажмите иконку фильтра.</li>
         </ol>
       <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Filter.png"
               alt="filter" loading="lazy">
        </div>
        <figcaption>filter</figcaption>
      </figure></div>
            <ol>
          <li>Откройте панель c командами логики нажав на "карандаш" .</li>
         </ol>
        <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Edit.png"
               alt="Edit" loading="lazy">
        </div>
        <figcaption>Edit</figcaption>
      </figure></div>
             <ol>
        <li>Выберите правило <strong> recode by attribute</strong> .</li>
                     </ol>
            <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Recode2.png"
               alt="recode2" loading="lazy">
        </div>
        <figcaption>recode2</figcaption>
      </figure></div>
        <ol>
          <li>В поле <em>Select option</em> укажите вопрос <strong>q1</strong>. В <em>пустом окне</em> введите название атрибута, который используем для перекодировки -  <strong>new</strong>.</li>
              </ol>
         <div class="fig"><figure>
        <div class="media">
          <img src="https://raw.githubusercontent.com/scm1ok-source/quest/main/Recode3.png"
               alt="recode2" loading="lazy">
        </div>
        <figcaption>recode2</figcaption>
      </figure></div>
        <ol>
        <li>Сохраните правило. </li>
         </ol>
        <div class="checklist" data-step="5">
          <label><input type="checkbox"> Активна иконка фильтров у q2</label>
          <label><input type="checkbox"> Выбрано «recode by attribute» </label>
          <label><input type="checkbox"> Указаны правила Select Option=Q1 и атрибут new</label>
        </div>
      </div>
    </section>

   <!-- Шаг 6 -->
 <section class="step">
      <h2>5) Скройте вопрос q2 от респондентов </h2>
      <div class="step">
        <ol>
          <li>Сделайте апдейт ссылки и проверьте корректность работы перекодировки. </li>
          <li> На панели c командами логики выберите <strong>ASK NEVER</strong>.</li>
            <li>Сохраните изменения.</li>
        </ol>
               <div class="checklist" data-step="5">
          <label><input type="checkbox"> Перекодировка корректно работает </label>
          <label><input type="checkbox"> q2 скрыт от респондентов </label>
         </div>
      </div>
    </section>
    <!-- Частые ошибки -->
    <section class="card" id="mistakes">
      <h2>Частые ошибки и быстрые решения</h2>
      <div class="grid two">
               <div class="step"><strong>Источник не тот</strong><br><span class="muted">В Select Option должен быть выбран именно q1.</span></div>
        <div class="step"><strong>Опечатка в названии свойства</strong><br><span class="muted">«New» должно совпадать до символа и регистра.</span></div>
        <div class="step"><strong>Нет вариантов ответов из атрибута new (1/2)  в q2</strong><br><span class="muted">Добавьте их вручную перед настройкой recode.</span></div>
          <div class="step"><strong>Не все коды из атрубита new указаны в q2</strong><br><span class="muted">Если в колонке new использовали коды 1, 2, 3, 4, 5,  то все 5 значений должны быть прописаны в q2.</span></div>
      </div>
    </section>

   <hr>
    <a id="finish" class="btn" href="#top" disabled>Квест пройден ✓</a>
    <p class="subtitle">Кнопка активируется автоматически, когда все чек-листы отмечены.</p>
  </div>

  <!-- Плавающий прогресс (исправляет «не фиксируется») -->
  <aside class="progress-dock" aria-live="polite">
    <div class="head">
      <strong>Прогресс квеста</strong>
      <span class="muted" id="progress-label">0% выполнено</span>
    </div>
    <div class="progress" aria-label="Прогресс"><span id="progress-bar"></span></div>
  </aside>
</body></html>













































